#! /usr/bin/env python3

import re
import numpy as np
from crewp.dftbplus.pdos import PDOS as PDOS_dp
from crewp.spectra.pdos import PDOS
import ase.io

import matplotlib as mpl
from matplotlib import rc
import matplotlib.pyplot as plt

mpl.rcParams.update({'font.size': 16,
                     'font.family': "serif",
                     #'font.serif': [],                   
                     #'font.sans-serif': ["DejaVu Sans"], 
                     'mathtext.default' : 'regular',
                    })

genfname = 'geoinp.gen'

atoms = ase.io.read(genfname)
coordinates = atoms.get_positions()

pdos = PDOS(None)
pdos.read_df('pdos_df.dat', header=[0,1] )
pdos.sum_shell()
ldos, x_arry, en_arry = pdos.ldos1d(coordinates=coordinates, )

x_mesh, en_mesh = np.meshgrid( x_arry, en_arry, indexing='ij' )
plt.contourf( x_mesh, en_mesh, ldos, 50,)# cmap='RdGy')
plt.colorbar()
plt.xlabel(r'$x \: (Ã…)$',)
plt.ylabel(r'$Energy \: (eV)$',)

plt.show()
